var draw=function(){var e=document.querySelector("main"),t=e.offsetWidth,n=e.offsetHeight,r=document.createElement("canvas"),o=r.getContext("2d"),a=r.getBoundingClientRect(),i=0,d=0,l=0,s=0,c=0,u=0;shape="";var h=!1,w="",g="",f=[],m=0,C=[];return{setIsDrawing:function(e){h=e},getIsDrawing:function(){return h},getShape:function(){return shape},setShape:function(e){shape=e},randColor:function(){return"#"+Math.floor(16777215*Math.random()).toString(16)},setStrokeColor:function(e){w=e},setFillColor:function(e){g=e},getStrokeColor:function(){return 0<w.length?w:this.randColor()},getFillColor:function(){return 0<g.length?g:this.randColor()},setStart:function(){l=i,s=d},setEnd:function(){c=i,u=d},setXY:function(e){lx=i,ly=d,i=e.clientX-a.left-r.offsetLeft,d=e.clientY-a.top-r.offsetTop},writeXY:function(){document.getElementById("trackX").innerHTML="X: "+i,document.getElementById("trackY").innerHTML="Y: "+d},setPoint:function(){f[m]=[],f[m].x=i,f[m].y=d,2<f.length?(this.draw(),console.log(f),m=0,f=[]):m++},draw:function(){switch(o.restore(),shape){case"rectangle":this.drawRect();break;case"line":this.drawLine();break;case"circle":this.drawCircle();break;case"path":this.drawPath();break;case"triangle":this.drawTriangle();break;case"3-point":this.draw3Point();break;default:alert("Please choose a shape")}o.save(),console.log(C)},drawRect:function(){o.fillStyle=this.randColor(),o.strokeStyle=this.randColor(),o.fillRect(l,s,c-l,u-s)},drawLine:function(){o.strokeStyle=this.randColor(),o.beginPath(),o.moveTo(l,s),o.lineTo(c,u),o.stroke()},drawCircle:function(){o.strokeStyle=this.randColor(),o.fillStyle=this.randColor();var e=l-c,t=s-u,n=Math.sqrt(e*e+t*t);o.beginPath(),o.arc(l,s,n,0,2*Math.PI),o.stroke(),o.fill()},drawPath:function(){o.strokeStyle=this.randColor(),o.beginPath(),o.moveTo(lx,ly),o.lineTo(i,d),o.stroke()},getCanvas:function(){return r},drawTriangle:function(){var e=l-c,t=s-u,n=Math.sqrt(e*e+t*t),r=l+n,a=s+n;c<l&&(r=l-n),u<s&&(a=s-n),o.fillStyle=this.getFillColor(),o.strokeStyle=this.getStrokeColor(),o.beginPath(),o.moveTo(l,s),o.lineTo(r,a),o.lineTo(c,u),o.lineTo(l,s),o.stroke(),o.fill()},draw3Point:function(){o.strokeStyle=this.getStrokeColor(),o.fillStyle=this.getFillColor(),o.beginPath(),o.moveTo(f[0].x,f[0].y),o.lineTo(f[1].x,f[1].y),o.lineTo(f[2].x,f[2].y),o.lineTo(f[0].x,f[0].y),o.stroke(),o.fill(),C.push({shape:"3-point",cords:{points:f},styles:{stroke:o.strokeStyle,fill:o.fillStyle}})},Clear:function(){o.clearRect(0,0,r.width,r.height)},Redraw:function(){o.clearRect(0,0,r.width,r.height)},init:function(){r.width=t,r.height=n,document.querySelector("main").appendChild(r)}}}();draw.init(),document.getElementById("btnRect").addEventListener("click",function(){draw.setShape("rectangle")}),document.getElementById("btnCircle").addEventListener("click",function(){draw.setShape("circle")}),document.getElementById("btnLine").addEventListener("click",function(){draw.setShape("line")}),document.getElementById("btnPath").addEventListener("click",function(){draw.setShape("path")}),document.getElementById("btnTriangle").addEventListener("click",function(){draw.setShape("triangle")}),document.getElementById("btn3Point").addEventListener("click",function(){draw.setShape("3-point")}),document.getElementById("btnClear").addEventListener("click",function(){draw.Clear()}),document.getElementById("btnRedraw").addEventListener("click",function(){draw.Redraw()}),document.getElementById("strokeColor").addEventListener("change",function(){draw.setStrokeColor(document.getElementById("strokeColor").value)}),document.getElementById("randStrokeColor").addEventListener("change",function(){draw.setStart("")}),document.getElementById("fillColor").addEventListener("change",function(){draw.setFillColor(document.getElementById("fillColor").value)}),document.getElementById("randFillColor").addEventListener("change",function(){draw.setStart("")}),draw.getCanvas().addEventListener("mousedown",function(){draw.setStart(),draw.setIsDrawing(!0)}),draw.getCanvas().addEventListener("mouseup",function(){draw.setEnd(),draw.draw(),draw.setIsDrawing(!1)}),draw.getCanvas().addEventListener("mousemove",function(e){draw.setXY(e),draw.writeXY(),"path"===draw.getShape()&&!0===draw.getIsDrawing()&&draw.draw(),draw.getCanvas().addEventListener("mousedown",function(){"3-Point"!==draw.getShape()&&(draw.setStart(),draw.setIsDrawing(!0))}),draw.getCanvas().addEventListener("mouseup",function(){"3-Point"!==draw.getShape()&&(draw.setEnd(),draw.draw(),draw.setIsDrawing(!1))}),draw.getCanvas().addEventListener("mouseup",function(){"3-Point"!==draw.getShape()&&draw.setPoint()})});